{"version":3,"sources":["src/gatsby-node.js"],"names":["fetch","require","api_url","exports","sourceNodes","reporter","actions","createNodeId","createContentDigest","options","warn","SAPHY_KEY","undefined","createNode","uri","resp","data","json","forEach","datum","nodeContent","JSON","stringify","nodeMeta","id","_id","parent","children","internal","type","content","contentDigest","node","Object","assign","console","log"],"mappings":";;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,YAAD,CAArB;;AACA,MAAMC,OAAO,GAAG,yCAAhB;;AAEAC,OAAO,CAACC,WAAR,GAAsB,OAAO;AACzBC,EAAAA,QADyB;AAEzBC,EAAAA,OAFyB;AAGzBC,EAAAA,YAHyB;AAIzBC,EAAAA;AAJyB,CAAP,EAKjBC,OALiB,KAKL;AACbJ,EAAAA,QAAQ,CAACK,IAAT,CAAc,mCAAmCD,OAAO,CAACE,SAAzD;;AAEA,MAAIF,OAAO,CAACE,SAAR,KAAsBC,SAA1B,EAAqC;AACnCP,IAAAA,QAAQ,CAACK,IAAT,CAAc,uBAAd;AACA,WAAO,IAAP;AACD;;AAED,QAAM;AACJG,IAAAA;AADI,MAEFP,OAFJ,CARa,CAUA;AACb;;AAEA,QAAMQ,GAAG,GAAI,GAAEZ,OAAQ,wCAAuCO,OAAO,CAACE,SAAU,EAAhF;AAEA,QAAMI,IAAI,GAAG,MAAMf,KAAK,CAACc,GAAD,CAAxB;AACA,QAAME,IAAI,GAAG,MAAMD,IAAI,CAACE,IAAL,EAAnB;AACAD,EAAAA,IAAI,CAACE,OAAL,CAAaC,KAAK,IAAI;AACpB,UAAMC,WAAW,GAAGC,IAAI,CAACC,SAAL,CAAeH,KAAf,CAApB;AACA,UAAMI,QAAQ,GAAG;AACf;AACAC,MAAAA,EAAE,EAAEjB,YAAY,CAAE,SAAQY,KAAK,CAACM,GAAI,EAApB,CAFD;AAGfC,MAAAA,MAAM,EAAE,IAHO;AAIfC,MAAAA,QAAQ,EAAE,EAJK;AAKfC,MAAAA,QAAQ,EAAE;AACR;AACAC,QAAAA,IAAI,EAAG,OAFC;AAGRC,QAAAA,OAAO,EAAEV,WAHD;AAIRW,QAAAA,aAAa,EAAEvB,mBAAmB,CAACW,KAAD;AAJ1B;AALK,KAAjB;AAYA,UAAMa,IAAI,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBf,KAAlB,EAAyBI,QAAzB,CAAb,CAdoB,CAc6B;;AAEjDY,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BjB,KAAK,CAACM,GAAlC;AACAZ,IAAAA,UAAU,CAACmB,IAAD,CAAV;AACD,GAlBD,EAjBa,CAmCT;;AAEJ;AACD,CA3CH","sourcesContent":["const fetch = require(\"node-fetch\");\r\nconst api_url = \"https://happy-colden-65fff2.netlify.com\"\r\n\r\nexports.sourceNodes = async ({\r\n    reporter,\r\n    actions,\r\n    createNodeId,\r\n    createContentDigest\r\n  }, options) => {\r\n    reporter.warn(\"------pluginOptions.SAPHY_KEY \" + options.SAPHY_KEY);\r\n  \r\n    if (options.SAPHY_KEY === undefined) {\r\n      reporter.warn(\"SAPHY_KEY is not set \");\r\n      return null;\r\n    }\r\n  \r\n    const {\r\n      createNode\r\n    } = actions; // Create nodes here, generally by downloading data\r\n    // from a remote API.\r\n  \r\n    const uri = `${api_url}/.netlify/functions/listProducts?key=${options.SAPHY_KEY}`\r\n  \r\n    const resp = await fetch(uri);\r\n    const data = await resp.json();\r\n    data.forEach(datum => {\r\n      const nodeContent = JSON.stringify(datum);\r\n      const nodeMeta = {\r\n        // the prod unique id is in _id\r\n        id: createNodeId(`saphy-${datum._id}`),\r\n        parent: null,\r\n        children: [],\r\n        internal: {\r\n          // this will be important in finding the node\r\n          type: `saphy`,\r\n          content: nodeContent,\r\n          contentDigest: createContentDigest(datum)\r\n        }\r\n      };\r\n      const node = Object.assign({}, datum, nodeMeta); // remove this once it works!\r\n  \r\n      console.log('\\n prod --> ', datum._id);\r\n      createNode(node);\r\n    }); // We're done, return.\r\n  \r\n    return;\r\n  };"],"file":"gatsby-node.js"}